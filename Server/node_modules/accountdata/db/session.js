var conn = require('./conn.js');
var convert = require('./convert.js');

function Session(dictionary) {
    this.dictionary = dictionary;
}

exports.find = function(accountId, sessionId, callback) {
    var query = {'account': accountId, 
                 'id': convert.convertData(sessionId, 'Binary')};
    conn.withDb(function (err1, db) {
        if (err1) {
            callback(err1, null);
            return;
        }
        var sessions = db.collection('sessions');
        sessions.findOne(query, function (err2, doc) {
            if (err2) {
                callback(err2, null);
                return;
            }
            if (!doc) {
                callback(new Error('Session not found'), null);
            } else {
                callback(null, new Session(doc));
            }
        });
    });
}

exports.add = function(accountId, sessionData, callback) {
    
}
